import{r as i,j as e,$ as m}from"./app-DcA4OvQM.js";import{U as M}from"./UserLayout-CvYy6IBB.js";import"./user-BPb7GXe4.js";function T({user:x,learningStats:t,upcomingAppointments:u=[]}){var j;const[P,C]=i.useState("overview"),[r,y]=i.useState(null),[n,v]=i.useState([]),[N,g]=i.useState(!0),[f,b]=i.useState(null);i.useEffect(()=>{let s=!0;async function l(){try{g(!0);const[d,a]=await Promise.all([fetch("/api/fertility-tracking",{credentials:"include"}),fetch("/api/reminders",{credentials:"include"})]),c=d.ok?await d.json():null,o=a.ok?await a.json():null;if(!s)return;y((c==null?void 0:c.predictions)??null),v(Array.isArray(o==null?void 0:o.data)?o.data:[])}catch{if(!s)return;b("Failed to load dashboard data")}finally{s&&g(!1)}}return l(),()=>{s=!1}},[]);const w=[{title:"Learn Hub",description:"Educational content on SRHR",icon:"ðŸ“š",href:"/user/learn",color:"blue"},{title:"Quiz & Challenges",description:"Test your knowledge",icon:"ðŸ§ ",href:"/user/quiz",color:"purple"},{title:"Ask a Question",description:"Get expert answers",icon:"â“",href:"/user/ask",color:"green"},{title:"Services Near You",description:"Find local SRHR services",icon:"ðŸ“",href:"/user/services",color:"orange"}],h=i.useMemo(()=>{if(!r)return{title:"Daily Health Tip",content:"Regular exercise can help regulate your menstrual cycle and reduce PMS symptoms. Aim for at least 30 minutes of moderate activity most days of the week.",category:"Physical Health"};const s=r.current_phase;return{menstrual:{title:"Care during Period",content:"Stay hydrated and consider light movement like walking or yoga to ease cramps.",category:"Cycle Support"},follicular:{title:"Energy Boost Phase",content:"A great time to learn and be active. Consider starting a new module today.",category:"Learning"},ovulatory:{title:"Fertility Peak",content:"Ovulation estimated. If avoiding pregnancy, use protection. If trying to conceive, this is your window.",category:"Family Planning"},luteal:{title:"Pre-period Care",content:"Focus on sleep and balanced meals. Track any PMS symptoms for patterns.",category:"Wellness"}}[s]??{title:"Your Health",content:"Track your cycle to get personalized insights on your dashboard.",category:"Overview"}},[r]),p=i.useMemo(()=>{var d;const s=[];r!=null&&r.next_period&&s.push({title:"Expected period",date:r.next_period,type:"reminder"}),(d=r==null?void 0:r.fertile_window)!=null&&d.start&&s.push({title:"Fertile window starts",date:r.fertile_window.start,type:"reminder"}),r!=null&&r.ovulation_day&&s.push({title:"Estimated ovulation",date:r.ovulation_day,type:"reminder"});const l=n.filter(a=>a==null?void 0:a.reminder_time).map(a=>({title:a.message??a.type??"Reminder",date:(a.reminder_time||"").slice(0,10),type:"reminder"})).slice(0,5);return[...s,...l]},[r,n]),_=i.useMemo(()=>{var a,c;const s=o=>{try{const k=new Date(o),L=new Date;return Math.ceil((k.setHours(0,0,0,0)-L.setHours(0,0,0,0))/(1e3*60*60*24))}catch{return null}},l=r!=null&&r.next_period?s(r.next_period):null,d=[];return r!=null&&r.next_period&&d.push({title:"Next Period",value:r.next_period,change:l===null?"":l===0?"today":`${l>0?"in "+l:Math.abs(l)+" days ago"}`,color:"purple"}),(a=r==null?void 0:r.fertile_window)!=null&&a.start&&((c=r==null?void 0:r.fertile_window)!=null&&c.end)&&d.push({title:"Fertile Window",value:`${r.fertile_window.start} â†’ ${r.fertile_window.end}`,change:r!=null&&r.ovulation_day?`Ovulation ${r.ovulation_day}`:"",color:"emerald"}),r!=null&&r.current_phase&&r.current_phase!=="unknown"&&d.push({title:"Cycle Phase",value:r.current_phase,change:"based on latest log",color:"indigo"}),d},[r,n]);return e.jsx(M,{user:x,role:"user",currentPath:"/user/dashboard",children:e.jsxs("div",{className:"",children:[e.jsx("div",{className:"mb-6 rounded-lg bg-gradient-to-r from-green-600 to-emerald-600 text-white",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold",children:["Welcome back, ",(x==null?void 0:x.name)||"User","!"]}),e.jsx("p",{className:"mt-2 text-green-100",children:N?"Loading your insightsâ€¦":f?"Unable to load your latest insights":"Your personalized health insights are ready"})]}),e.jsx("div",{className:"hidden md:block",children:e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-green-100",children:"Learning Streak"}),e.jsxs("p",{className:"text-2xl font-bold",children:[(t==null?void 0:t.learning_streak_days)??0," ",(t==null?void 0:t.learning_streak_days)===1?"day":"days"]})]})})]})})}),e.jsxs("div",{className:"space-y-6",children:[t&&e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"rounded-lg bg-blue-100 p-2",children:e.jsx("div",{className:"h-6 w-6 rounded bg-blue-500"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Average Score"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[t.average_score,"%"]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.completed_lessons," lessons completed"]})]})]})}),e.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"rounded-lg bg-purple-100 p-2",children:e.jsx("div",{className:"h-6 w-6 rounded bg-purple-500"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overall Progress"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[t.overall_progress,"%"]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.completed_modules,"/",t.total_modules_enrolled," modules"]})]})]})}),e.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"rounded-lg bg-emerald-100 p-2",children:e.jsx("div",{className:"h-6 w-6 rounded bg-emerald-500"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Lessons Completed"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.completed_lessons}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.total_lessons_attempted," attempted"]})]})]})}),e.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"rounded-lg bg-orange-100 p-2",children:e.jsx("div",{className:"h-6 w-6 rounded bg-orange-500"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Learning Streak"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.learning_streak_days}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.learning_streak_days===1?"day":"days"," in a row"]})]})]})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-4",children:_.map((s,l)=>e.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`rounded-lg p-2 ${s.color==="blue"?"bg-blue-100":s.color==="purple"?"bg-purple-100":s.color==="emerald"?"bg-emerald-100":"bg-indigo-100"}`,children:e.jsx("div",{className:`h-6 w-6 rounded ${s.color==="blue"?"bg-blue-500":s.color==="purple"?"bg-purple-500":s.color==="emerald"?"bg-emerald-500":"bg-indigo-500"}`})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.value}),e.jsx("p",{className:"text-sm text-gray-500",children:s.change})]})]})},l))}),e.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-4",children:[e.jsxs("div",{className:"space-y-6 lg:order-1 lg:col-span-3",children:[e.jsxs("div",{className:"rounded-lg bg-white shadow-lg",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Upcoming Appointments"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Your scheduled appointments"})]}),e.jsxs(m,{href:"/user/appointments",className:"flex items-center gap-1 text-sm font-medium text-blue-600 hover:text-blue-700",children:["View All",e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})}),e.jsx("div",{className:"p-6",children:u.length===0?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-gray-100",children:e.jsx("svg",{className:"h-8 w-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("p",{className:"mt-4 text-sm font-medium text-gray-900",children:"No upcoming appointments"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Schedule your next appointment to get started"}),e.jsx(m,{href:"/user/appointments",className:"mt-4 inline-flex items-center rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700",children:"Book an appointment"})]}):e.jsx("div",{className:"space-y-4",children:u.map(s=>e.jsx(m,{href:"/user/appointments",className:"group block rounded-xl border-2 border-gray-200 bg-white p-5 transition-all hover:border-blue-300 hover:bg-blue-50 hover:shadow-md",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"text-base font-semibold text-gray-900",children:s.doctor_name}),e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${s.status==="confirmed"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:s.status})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:s.specialization})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-6 text-sm",children:[e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx("svg",{className:"mr-2 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("span",{className:"font-medium",children:s.appointment_date_formatted})]}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx("svg",{className:"mr-2 h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"font-medium",children:s.appointment_time_formatted})]})]}),s.reason&&e.jsx("div",{className:"mt-3 rounded-lg bg-gray-50 p-3",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Reason:"})," ",s.reason]})})]}),s.days_until!==null&&s.days_until>=0&&e.jsx("div",{className:"ml-4 text-right",children:e.jsx("div",{className:`inline-flex items-center rounded-full px-3 py-1.5 text-xs font-semibold ${s.days_until===0?"bg-red-100 text-red-800":s.days_until===1?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:s.days_until===0?"Today":s.days_until===1?"Tomorrow":`${s.days_until} days`})})]})},s.id))})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-lg bg-white shadow-lg",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:h.title})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-green-100 to-emerald-100",children:e.jsx("span",{className:"text-lg",children:"ðŸ’¡"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm leading-relaxed text-gray-700",children:h.content}),e.jsx("p",{className:"mt-3 text-xs font-medium text-green-600",children:h.category})]})]})})]}),p.length>0&&e.jsxs("div",{className:"rounded-lg bg-white shadow-lg",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Upcoming Events"})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:p.map((s,l)=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`h-3 w-3 flex-shrink-0 rounded-full ${s.type==="reminder"?"bg-blue-500":s.type==="quiz"?"bg-purple-500":"bg-green-500"}`}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-medium text-gray-900",children:s.title}),e.jsx("p",{className:"text-xs text-gray-500",children:s.date})]})]},l))})})]})]})]}),e.jsx("div",{className:"lg:order-2 lg:col-span-1",children:e.jsxs("div",{className:"sticky top-6 rounded-lg bg-white shadow-lg",children:[e.jsxs("div",{className:"border-b border-gray-200 px-6 py-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Quick Links"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Quick access to features"})]}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"space-y-3",children:w.map((s,l)=>e.jsxs(m,{href:s.href,className:`group flex items-center space-x-3 rounded-lg border-2 border-transparent p-3 transition-all duration-200 ${s.color==="blue"?"hover:border-blue-200 hover:bg-blue-50":s.color==="purple"?"hover:border-purple-200 hover:bg-purple-50":s.color==="green"?"hover:border-green-200 hover:bg-green-50":s.color==="orange"?"hover:border-orange-200 hover:bg-orange-50":s.color==="pink"?"hover:border-pink-200 hover:bg-pink-50":"hover:border-indigo-200 hover:bg-indigo-50"}`,children:[e.jsx("div",{className:`flex-shrink-0 rounded-lg p-2 text-xl ${s.color==="blue"?"bg-blue-100":s.color==="purple"?"bg-purple-100":s.color==="green"?"bg-green-100":s.color==="orange"?"bg-orange-100":s.color==="pink"?"bg-pink-100":"bg-indigo-100"}`,children:s.icon}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 group-hover:text-gray-700",children:s.title}),e.jsx("p",{className:"mt-0.5 truncate text-xs text-gray-500",children:s.description})]}),e.jsx("svg",{className:"h-4 w-4 flex-shrink-0 text-gray-400 group-hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]},l))})})]})})]}),e.jsxs("div",{className:"rounded-lg bg-white shadow",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Recent Activity"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[(t==null?void 0:t.recent_completions)&&t.recent_completions.length>0&&e.jsx(e.Fragment,{children:t.recent_completions.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-purple-500"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Completed: ",s.lesson_title]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.module_title," â€¢ ",s.time_ago," â€¢ Score: ",s.score,"%"]})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"inline-flex items-center rounded-full bg-green-100 px-2 py-1 text-xs font-medium text-green-800",children:"Completed"})})]},s.id))}),n.length>0&&e.jsx(e.Fragment,{children:n.slice(0,6-(((j=t==null?void 0:t.recent_completions)==null?void 0:j.length)||0)).map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.message??s.type}),e.jsx("p",{className:"text-xs text-gray-500",children:(s.reminder_time||"").replace("T"," ").replace("Z","")})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${s.is_sent?"bg-gray-100 text-gray-800":"bg-green-100 text-green-800"}`,children:s.is_sent?"sent":"pending"})})]},s.id))}),(!(t!=null&&t.recent_completions)||t.recent_completions.length===0)&&n.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"No recent activity."})]})})]})]})]})})}export{T as default};
