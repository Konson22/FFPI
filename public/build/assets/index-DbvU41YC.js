import{K as W,r as g,S as k,j as e,$ as L}from"./app-DcA4OvQM.js";import{U as T}from"./UserLayout-CvYy6IBB.js";import"./user-BPb7GXe4.js";function U({user:M,enrolledCourse:h,enrolledCourses:x,availableCourses:C,enrolledCourseIds:u,canEnrollMore:_}){const{flash:r}=W().props,[p,a]=g.useState(""),[j,i]=g.useState("");g.useEffect(()=>{r!=null&&r.error&&(a(r.error),setTimeout(()=>a(""),5e3)),r!=null&&r.success&&(i(r.success),setTimeout(()=>i(""),5e3),r.success.includes("Enrolled")&&setTimeout(()=>k.reload(),1e3))},[r]);const d=x&&x.length>0?x:h?[h]:[],c=C||[],E=s=>{switch(s){case"enrolled":return"bg-blue-100 text-blue-800";case"started":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},S=s=>{var t;return((t=s.pivot)==null?void 0:t.progress_percentage)||0},b=s=>{var t;return((t=s.modules)==null?void 0:t.reduce((n,o)=>{var l;return n+(((l=o.lessons)==null?void 0:l.length)||0)},0))||0},$=s=>{var n,o;return(((o=(n=s.modules)==null?void 0:n[0])==null?void 0:o.lessons)||[]).filter(l=>l.is_completed).length},B=(s,t)=>{k.post(`/user/learn/enroll/${s}`,{},{onSuccess:()=>{i(`Successfully enrolled in ${t}`)},onError:n=>{console.error("Enrollment failed:",n),a("Failed to enroll in the module. Please try again.")}})};return e.jsx(T,{user:M,role:"user",currentPath:"/user/learn",children:e.jsxs("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:[p&&e.jsx("div",{className:"mb-4 rounded-lg border border-red-300 bg-red-50 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"mr-3 h-5 w-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),e.jsx("p",{className:"font-medium text-red-800",children:p}),e.jsx("button",{onClick:()=>a(""),className:"ml-auto text-red-400 hover:text-red-600",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),j&&e.jsx("div",{className:"mb-4 rounded-lg border border-green-300 bg-green-50 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"mr-3 h-5 w-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsx("p",{className:"font-medium text-green-800",children:j}),e.jsx("button",{onClick:()=>i(""),className:"ml-auto text-green-400 hover:text-green-600",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Learning Journey"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Continue your enrolled modules and discover new ones"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"My Enrolled Modules"}),e.jsxs("span",{className:"rounded-full bg-green-100 px-3 py-1 text-sm font-medium text-green-800",children:[d.length," ",d.length===1?"Module":"Modules"]})]}),d.length>0?e.jsx("div",{className:"space-y-6",children:d.map(s=>{var f,N,v,y,w;const t=S(s),n=b(s),o=$(s),l=((N=(f=s.modules)==null?void 0:f[0])==null?void 0:N.lessons)||[],m=l.findIndex(P=>!P.is_completed);return e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white shadow-sm",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-4 flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-3",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:s.title}),e.jsx("span",{className:`rounded-full px-3 py-1 text-xs font-medium ${E(((v=s.pivot)==null?void 0:v.status)||"enrolled")}`,children:((y=s.pivot)==null?void 0:y.status)||"Enrolled"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Progress"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[t,"%"]})]}),e.jsx("div",{className:"h-3 w-full overflow-hidden rounded-full bg-gray-200",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 to-green-600 transition-all duration-500",style:{width:`${t}%`}})}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:[o," of ",n," lessons completed"]}),e.jsxs("span",{children:[n-o," remaining"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx(L,{href:`/user/learn/module/${s.id}`,className:"flex-1 rounded-lg bg-green-600 px-4 py-2 text-center text-sm font-medium text-white transition-colors hover:bg-green-700",children:((w=s.pivot)==null?void 0:w.status)==="completed"?"Review Module":"Continue Learning"}),m!==-1&&l[m]&&e.jsx(L,{href:`/user/learn/module/${s.id}/lesson/${l[m].id}`,className:"rounded-lg border border-green-600 px-4 py-2 text-sm font-medium text-green-600 transition-colors hover:bg-green-50",children:"Start Next Lesson"})]})]})},s.id)})}):e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-12 text-center shadow-sm",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"No enrolled modules"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Start your learning journey by enrolling in a module from the available courses."})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"sticky top-6",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Available Modules"}),e.jsx("span",{className:"rounded-full bg-blue-100 px-3 py-1 text-sm font-medium text-blue-800",children:c.length})]}),c.length>0?e.jsxs("div",{className:"space-y-4",children:[c.filter(s=>!u.includes(s.id)).map(s=>{const t=b(s);return e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm transition-shadow hover:shadow-md",children:[e.jsx("h3",{className:"mb-2 line-clamp-2 text-base font-semibold text-gray-900",children:s.title}),e.jsx("p",{className:"mb-3 line-clamp-2 text-xs text-gray-600",children:s.description}),e.jsxs("div",{className:"mb-3 flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:[t," lessons"]}),e.jsx("span",{className:"rounded-full bg-gray-100 px-2 py-1 text-xs font-medium",children:s.difficulty_level||"Beginner"})]}),e.jsx("button",{onClick:()=>B(s.id,s.title),className:"w-full rounded-lg bg-green-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-green-700",children:"Enroll Now"})]},s.id)}),c.filter(s=>!u.includes(s.id)).length===0&&e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 text-center",children:e.jsx("p",{className:"text-sm text-gray-500",children:"All available modules have been enrolled."})})]}):e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-6 text-center",children:e.jsx("p",{className:"text-sm text-gray-500",children:"No available modules at the moment."})})]})})]})]})})}export{U as default};
