import{r as o,j as e}from"./app-DcA4OvQM.js";import{U as D}from"./UserLayout-CvYy6IBB.js";import"./user-BPb7GXe4.js";function F({user:M,services:x=[],serviceCategories:S=[]}){const[E,$]=o.useState("list"),[h,C]=o.useState("all"),[i,P]=o.useState(""),[p,T]=o.useState(null),[B,O]=o.useState(!1),[l,A]=o.useState(null),[c,r]=o.useState(null),[j,d]=o.useState(!1),I={all:"ðŸ¥","family-planning":"ðŸ‘¶","sti-testing":"ðŸ”¬",counseling:"ðŸ’¬",emergency:"ðŸš¨",vaccination:"ðŸ’‰","mental-health":"ðŸ§ "},f={all:"All Services","family-planning":"Family Planning","sti-testing":"STI Testing",counseling:"Counseling",emergency:"Emergency Services",vaccination:"Vaccination","mental-health":"Mental Health"},w=[{id:"all",name:"All Services",icon:"ðŸ¥"},...S.map(t=>({id:t,name:f[t]||t.charAt(0).toUpperCase()+t.slice(1).replace(/-/g," "),icon:I[t]||"ðŸ¥"}))],N=(t,s,n,a)=>{if(!t||!s||!n||!a)return null;const m=6371,b=(n-t)*Math.PI/180,k=(a-s)*Math.PI/180,L=Math.sin(b/2)*Math.sin(b/2)+Math.cos(t*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(k/2)*Math.sin(k/2),z=2*Math.atan2(Math.sqrt(L),Math.sqrt(1-L));return m*z},u=(x&&x.length>0?x:[]).filter(t=>{const s=h==="all"||t.type===h,n=!i||t.name.toLowerCase().includes(i.toLowerCase())||t.address.toLowerCase().includes(i.toLowerCase());return s&&n}).map(t=>{var n,a;const s=l&&((n=t.coordinates)!=null&&n.lat)&&((a=t.coordinates)!=null&&a.lng)?N(l.lat,l.lng,t.coordinates.lat,t.coordinates.lng):null;return{...t,calculatedDistance:s}}).sort((t,s)=>t.calculatedDistance===null&&s.calculatedDistance===null?0:t.calculatedDistance===null?1:s.calculatedDistance===null?-1:t.calculatedDistance-s.calculatedDistance),W=t=>{const s=w.find(n=>n.id===t);return(s==null?void 0:s.name)||f[t]||"Health Service"},v=t=>{var s,n;return(s=t.coordinates)!=null&&s.lat&&((n=t.coordinates)!=null&&n.lng),t.address||"Address not available"},y=t=>{var n,a;if(!l||!((n=t.coordinates)!=null&&n.lat)||!((a=t.coordinates)!=null&&a.lng))return null;const s=N(l.lat,l.lng,t.coordinates.lat,t.coordinates.lng);return s===null?null:s<1?`${Math.round(s*1e3)}m away`:s<10?`${s.toFixed(1)}km away`:`${Math.round(s)}km away`},g=o.useCallback(()=>{if(!navigator.geolocation){r("Geolocation is not supported by your browser."),d(!1);return}d(!0),r(null),navigator.geolocation.getCurrentPosition(t=>{A({lat:t.coords.latitude,lng:t.coords.longitude}),r(null),d(!1)},t=>{console.error("Error getting location:",t);let s="Unable to get your location.",n="";switch(t.code){case t.PERMISSION_DENIED:s="Location access denied.",n="Please enable location permissions in your browser settings. Click the lock icon in your address bar and allow location access.";break;case t.POSITION_UNAVAILABLE:s="Location information is unavailable.",n="Your device may not have GPS or location services enabled. Please check your device settings.";break;case t.TIMEOUT:s="Location request timed out.",n="The location request took too long. Please try again.";break;default:s="Unable to get your location.",n="Please check your browser settings and ensure location services are enabled.";break}window.location.protocol!=="https:"&&window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1"&&(n+=" Note: Geolocation requires HTTPS in production. Your site appears to be running on HTTP."),r(s+(n?` ${n}`:"")),d(!1)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e5})},[]);return o.useEffect(()=>{g()},[g]),e.jsx(D,{user:M,role:"user",currentPath:"/user/services",children:e.jsxs("div",{children:[e.jsxs("div",{className:"mb-8 rounded-lg bg-gradient-to-r from-green-600 to-emerald-600 p-6 text-white shadow-lg",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Services Near You"}),e.jsx("p",{className:"mt-2 text-green-100",children:"Find trusted local sexual and reproductive health services"}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),e.jsx("span",{children:"Verified Providers"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("span",{children:"Location Based"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:"Real-time Availability"})]})]})]}),e.jsx("div",{className:"mb-6 flex flex-wrap gap-2",children:w.map(t=>e.jsxs("button",{onClick:()=>C(t.id),className:`inline-flex items-center rounded-full px-4 py-2 text-sm font-medium transition-all ${h===t.id?"scale-105 bg-gradient-to-r from-green-600 to-emerald-600 text-white shadow-lg":"border border-gray-200 bg-white text-gray-700 shadow hover:shadow-md"}`,children:[e.jsx("span",{className:"mr-2 text-lg",children:t.icon}),t.name]},t.id))}),e.jsxs("div",{className:"mb-6 rounded-lg bg-white p-4 shadow",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"ðŸ” Search by location, service, or provider...",value:i,onChange:t=>P(t.target.value),className:"w-full rounded-lg border border-gray-300 px-4 py-3 text-sm transition-all focus:border-green-500 focus:ring-2 focus:ring-green-500"})}),e.jsx("div",{className:"text-sm text-gray-600 sm:flex sm:items-center",children:e.jsxs("span",{className:"inline-flex items-center rounded-lg bg-gray-100 px-4 py-3",children:[e.jsx("svg",{className:"mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),u.length," services found"]})})]}),c&&e.jsx("div",{className:"mt-3 rounded-lg border border-yellow-200 bg-yellow-50 p-3 text-sm text-yellow-800",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"mt-0.5 mr-2 h-4 w-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-medium",children:[c.split(". ")[0],"."]}),c.includes(". ")&&e.jsx("p",{className:"mt-1 text-xs text-yellow-700",children:c.split(". ").slice(1).join(". ")}),e.jsx("p",{className:"mt-1 text-xs text-yellow-700",children:"Services will still be shown, but without distance sorting."})]})]}),e.jsxs("div",{className:"ml-3 flex gap-2",children:[e.jsx("button",{onClick:g,disabled:j,className:"rounded px-2 py-1 text-xs font-medium text-yellow-800 hover:bg-yellow-100 disabled:cursor-not-allowed disabled:opacity-50",children:j?"Getting...":"Retry"}),e.jsx("button",{onClick:()=>r(null),className:"rounded px-2 py-1 text-xs font-medium text-yellow-800 hover:bg-yellow-100",children:"Dismiss"})]})]})}),l&&e.jsx("div",{className:"mt-3 rounded-lg border border-green-200 bg-green-50 p-3 text-sm text-green-800",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Location detected. Services sorted by distance."]})})]}),e.jsx("div",{className:"space-y-4",children:u.map(t=>e.jsx("div",{className:`group rounded-xl bg-white shadow transition-all duration-300 ${p===t.id?"ring-opacity-50 shadow-2xl ring-4 ring-green-500":"hover:shadow-lg"}`,onClick:()=>T(p===t.id?null:t.id),children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600",children:W(t.type)})]}),e.jsxs("div",{className:"mb-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-1 text-sm text-gray-600",children:"ðŸ“ Address"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:v(t)}),y(t)&&e.jsx("p",{className:"text-xs text-gray-500",children:y(t)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-1 text-sm text-gray-600",children:"â­ Rating"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.rating}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",t.reviews," reviews)"]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:`flex items-center space-x-1 ${t.isOpen?"text-green-600":"text-red-600"}`,children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${t.isOpen?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm font-medium",children:t.isOpen?"Open Now":"Closed"})]}),t.isOpen&&t.waitTime&&e.jsxs("span",{className:"text-sm text-gray-600",children:["Wait time: ",t.waitTime]})]})]}),e.jsxs("div",{className:"ml-4 flex flex-col gap-2 sm:flex-row lg:flex-col",children:[e.jsxs("button",{onClick:s=>{var a,m;s.stopPropagation();const n=v(t);(a=t.coordinates)!=null&&a.lat&&((m=t.coordinates)!=null&&m.lng)?window.open(`https://maps.google.com/?q=${t.coordinates.lat},${t.coordinates.lng}`,"_blank"):window.open(`https://maps.google.com/?q=${encodeURIComponent(n)}`,"_blank")},className:"inline-flex items-center justify-center rounded-lg bg-gradient-to-r from-green-600 to-emerald-600 px-4 py-2.5 text-sm font-medium whitespace-nowrap text-white transition-all hover:from-green-700 hover:to-emerald-700 active:scale-95",children:[e.jsxs("svg",{className:"mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Directions"]}),e.jsxs("button",{onClick:s=>{s.stopPropagation(),window.location.href=`tel:${t.phone}`},className:"inline-flex items-center justify-center rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium whitespace-nowrap text-gray-700 transition-all hover:bg-gray-50 active:scale-95",children:[e.jsx("svg",{className:"mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Call"]})]})]})})},t.id))}),u.length===0&&e.jsx("div",{className:"py-12 text-center",children:e.jsxs("div",{className:"text-gray-500",children:[e.jsxs("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No services found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Try adjusting your search criteria or location."})]})})]})})}export{F as default};
