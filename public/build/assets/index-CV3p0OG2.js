import{K as E,r as o,m as A,j as e,L as U}from"./app-DcA4OvQM.js";import{A as L}from"./AdminLayout-B2rIqxXb.js";function q({users:b,user:p}){const{flash:t}=E().props,[r,d]=o.useState([]),[j,i]=o.useState(!1),[g,f]=o.useState("all"),[x,y]=o.useState(""),{data:m,setData:a,post:N,processing:h,errors:u}=A({user_ids:[],subject:"",message:""}),n=b.filter(s=>{const l=g==="all"||s.role===g,c=s.name.toLowerCase().includes(x.toLowerCase())||s.email.toLowerCase().includes(x.toLowerCase());return l&&c}),v=s=>{const l=s.target.checked;if(i(l),l){const c=n.map(k=>k.id);d(c),a("user_ids",c)}else d([]),a("user_ids",[])},w=s=>{const l=r.includes(s)?r.filter(c=>c!==s):[...r,s];d(l),a("user_ids",l),i(l.length===n.length&&n.length>0)},S=s=>{if(s.preventDefault(),r.length===0){alert("Please select at least one user to send the email to.");return}N("/admin/emails/send",{onSuccess:()=>{d([]),i(!1),a({user_ids:[],subject:"",message:""})}})},C=s=>{switch(s){case"admin":return"bg-red-100 text-red-800";case"expert":return"bg-green-100 text-green-800";case"user":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return o.useEffect(()=>{t!=null&&t.success&&alert(t.success)},[t]),e.jsxs(L,{user:p,currentPath:"/admin/emails",children:[e.jsx(U,{title:"Send Emails to Users"}),e.jsxs("div",{className:"space-y-6",children:[(t==null?void 0:t.success)&&e.jsx("div",{className:"rounded-lg border border-green-200 bg-green-50 p-4",children:e.jsx("p",{className:"text-sm text-green-800",children:t.success})}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Send Emails to Users"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Compose and send emails to registered users"})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"rounded-lg bg-white p-6 shadow-md",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold text-gray-900",children:"Select Users"}),e.jsxs("div",{className:"mb-4 space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:x,onChange:s=>y(s.target.value),className:"w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-transparent focus:ring-2 focus:ring-[rgb(4,50,75)]"}),e.jsxs("select",{value:g,onChange:s=>f(s.target.value),className:"w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-transparent focus:ring-2 focus:ring-[rgb(4,50,75)]",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"user",children:"Users"}),e.jsx("option",{value:"expert",children:"Experts"})]})]}),e.jsx("div",{className:"mb-4 border-b border-gray-200 pb-4",children:e.jsxs("label",{className:"flex cursor-pointer items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:j,onChange:v,className:"h-4 w-4 rounded border-gray-300 text-[rgb(4,50,75)] focus:ring-[rgb(4,50,75)]"}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Select All (",n.length,")"]})]})}),e.jsx("div",{className:"max-h-96 space-y-2 overflow-y-auto",children:n.length===0?e.jsx("p",{className:"py-4 text-center text-sm text-gray-500",children:"No users found"}):n.map(s=>e.jsxs("label",{className:"flex cursor-pointer items-center space-x-3 rounded-lg border border-gray-200 p-3 hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",checked:r.includes(s.id),onChange:()=>w(s.id),className:"h-4 w-4 rounded border-gray-300 text-[rgb(4,50,75)] focus:ring-[rgb(4,50,75)]"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"truncate text-xs text-gray-500",children:s.email}),e.jsx("span",{className:`mt-1 inline-block rounded px-2 py-0.5 text-xs font-medium ${C(s.role)}`,children:s.role})]})]},s.id))}),r.length>0&&e.jsx("div",{className:"mt-4 border-t border-gray-200 pt-4",children:e.jsxs("p",{className:"text-sm font-medium text-gray-700",children:[r.length," user",r.length!==1?"s":""," selected"]})})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("form",{onSubmit:S,className:"space-y-6 rounded-lg bg-white p-6 shadow-md",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold text-gray-900",children:"Compose Email"}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"subject",className:"mb-2 block text-sm font-medium text-gray-700",children:["Subject ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"subject",value:m.subject,onChange:s=>a("subject",s.target.value),required:!0,className:"w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-transparent focus:ring-2 focus:ring-[rgb(4,50,75)]",placeholder:"Email subject..."}),u.subject&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.subject})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"message",className:"mb-2 block text-sm font-medium text-gray-700",children:["Message ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"message",value:m.message,onChange:s=>a("message",s.target.value),required:!0,rows:12,className:"w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-transparent focus:ring-2 focus:ring-[rgb(4,50,75)]",placeholder:"Write your message here... You can use plain text or basic formatting."}),u.message&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.message}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Minimum 10 characters required. New lines will be preserved."})]}),r.length>0&&e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Preview:"})," This email will be sent to ",r.length," user",r.length!==1?"s":"","."]})}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>{d([]),i(!1),a({user_ids:[],subject:"",message:""})},className:"rounded-lg border border-gray-300 px-6 py-2 text-gray-700 hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 focus:outline-none",disabled:h,children:"Clear"}),e.jsx("button",{type:"submit",disabled:h||r.length===0||!m.subject||!m.message,className:"rounded-lg bg-gradient-to-r from-[rgb(4,50,75)] to-[rgb(29,84,114)] px-6 py-2 text-white transition-all hover:from-[rgb(29,84,114)] hover:to-[rgb(4,50,75)] focus:ring-2 focus:ring-[rgb(4,50,75)] focus:outline-none disabled:cursor-not-allowed disabled:opacity-50",children:h?"Sending...":`Send Email${r.length>0?` (${r.length})`:""}`})]})]})})]})]})]})}export{q as default};
