-- 1️⃣ MODULES TABLE
CREATE TABLE modules (
id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
module_code VARCHAR(100) UNIQUE,
title VARCHAR(255) NOT NULL,
description TEXT,
category VARCHAR(100),
duration VARCHAR(50),
target_audience JSON, -- e.g., ["youth","women","students"]
created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- 2️⃣ LESSONS TABLE
CREATE TABLE lessons (
id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
module_id BIGINT UNSIGNED,
title VARCHAR(255) NOT NULL,
content LONGTEXT,
key_points JSON, -- store list of bullet points
media_type VARCHAR(50),
media_url TEXT,
created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
FOREIGN KEY (module_id) REFERENCES modules(id) ON DELETE CASCADE
);

-- 3️⃣ RESOURCES TABLE
CREATE TABLE resources (
id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
lesson_id BIGINT UNSIGNED,
title VARCHAR(255),
link TEXT,
FOREIGN KEY (lesson_id) REFERENCES lessons(id) ON DELETE CASCADE
);

-- 4️⃣ QUIZZES TABLE
CREATE TABLE quizzes (
id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
lesson_id BIGINT UNSIGNED,
question TEXT,
correct_answer VARCHAR(255),
created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
FOREIGN KEY (lesson_id) REFERENCES lessons(id) ON DELETE CASCADE
);

-- 5️⃣ QUIZ OPTIONS TABLE
CREATE TABLE quiz_options (
id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
quiz_id BIGINT UNSIGNED,
option_text VARCHAR(255),
FOREIGN KEY (quiz_id) REFERENCES quizzes(id) ON DELETE CASCADE
);

-- 6️⃣ (OPTIONAL) USER PROGRESS TABLE
CREATE TABLE user_progress (
id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
user_id BIGINT UNSIGNED,
lesson_id BIGINT UNSIGNED,
is_completed BOOLEAN DEFAULT FALSE,
quiz_score INT DEFAULT 0,
completed_at TIMESTAMP NULL,
FOREIGN KEY (lesson_id) REFERENCES lessons(id) ON DELETE CASCADE
);
